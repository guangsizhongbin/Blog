---
title: "树莓派实现旁路由功能"
date: 2021-01-14T21:20:01+08:00
lastmod: 2021-01-14
author: "xiaonan"
math:
 enable: true


tags: [旁路由]
categories: [树莓派]
---

## 什么是WAN口和LAN口?

- WAN端口用于连接至Internet

- LAN端口用于连接局域网设备

![](https://img.fengqigang.cn//img/20210115071742.png)

图1不能访问的原因在于路由器2认为WAN口连接的是另外一个网络，而设备2访问设备1的IP地址是在同一个网络中，所以不会向WAN口发送网络包，因此不通。

[LAN口和WAN口的区别是什么](https://www.zhihu.com/question/20738115)

## 什么是网关？

网关(Gateway)就是一个网络连接到另一个网络的"关口"

### 什么是默认网关？

一个房间可又有多扇门一样，一台主机可又有多个网关。默认网关的意思是一台主机如果找不到可用的网关，就把数据包给默认指定的网关，由这个网关来处理数据包。现在主机使用的网关，一般指的是默认网关。

## 网关与路由器有什么关系？

- “网关”是一个概念，"路由器"是一个产品。


- 网关: 帮助两个不能直接互通的网络，进行数据转发的。

- 路由器，手机，防火墙均可实现网关功能:
	- 路由器将家庭局域网和互联网相连

	- 手机开了热点后，笔记本接进来，手机作为网关把笔记本和互联网相连

	- 防火墙可能做网关，局域网连至防火墙，防火墙把局域网和互联网相连

[网关和路由器的区别是什么?](https://www.zhihu.com/question/21787311)

## 旁路由如何实现？

![](https://img.fengqigang.cn//img/20210115081300.png)

### 网络数据在其中会怎样流动？

国内网站:

> 局域网设备发出数据 -> 到达主路由LAN1口 -> 到达主路由LAN2口 -> 到达旁路由LAN口 -> `旁路由分析数据走位` -> 到达旁路由LAN口 -> 到达主路由LAN2口 -> 到达主路由WAN口 -> 到达互连网

> 互联网服务器返回数据 -> 到达主路由WAN口 -> 到达主路由LAN1口 -> 到达局域网设备

国外网站:

> 局域网设备发出数据 -> 到达主路由LAN1口 -> 到达主路由LAN2口 -> 到达旁路由LAN口 -> `旁路由分析数据走位, 加密数据` -> 到达旁路由LAN口 -> 到达主路由LAN2口 -> 到达主路由WAN口 -> 到达互联网

> 互联网服务器返回数据 -> 到达主路由WAN口 -> 到达主路由LAN2口 -> 到达旁路由LAN口 -> `旁路由解密数据` -> 到达旁路由LAN口 -> 到达主路由LAN2口 -> 到达主路由LAN1口 -> 到达局域网设备

[OpenWrt中，旁路由的设置与使用](https://zhuanlan.zhihu.com/p/112484256)

### 旁路由实现

- `WAN口`

	ip: 192.168.1.2

	mask: 255.255.255.0

	broad: 192.168.1.1

	DNS: 192.168.1.1 0.0.0.0

- `LAN口`

	ip: 192.168.0.101

	mask: 255.255.255.0

- `raspberrypi`

	ip: 192.168.0.120

