<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Day20 - xiaonan&#39;s Blog</title><meta name="Description" content=""><meta property="og:title" content="Day20" />
<meta property="og:description" content="线程有哪5种状态? 新建:
刚创建的线程，没有执行 start() 方法， 没有资格去挣抢CPU资源
就绪
刚执行了 start 方法， 但是还没有获得CPU的执行权
执行
抢到了 CPU的执行权
阻塞
没有 CPU 的执行权，还缺少必要的条件（sleep 结束）
死亡
run 方法执行完之后
线程5个状态之间是如何转换? 用Runnable实现多线程?   实现 Runnable 接口
  重写 run 方法
  创建 Runnable 子类对象
  创建 Thread 对象， 并且把 Runnable 子类对象作为参数传递
  start 方法
  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  public class RunnableDemo { public static void main(String[] args) { MyRunnable myRunnable = new MyRunnable(); Thread thread = new Thread(myRunnable); thread." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://fengqigang.cn/posts/day20/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-04-21T17:00:51&#43;08:00" />
<meta property="article:modified_time" content="2021-04-21T00:00:00&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Day20"/>
<meta name="twitter:description" content="线程有哪5种状态? 新建:
刚创建的线程，没有执行 start() 方法， 没有资格去挣抢CPU资源
就绪
刚执行了 start 方法， 但是还没有获得CPU的执行权
执行
抢到了 CPU的执行权
阻塞
没有 CPU 的执行权，还缺少必要的条件（sleep 结束）
死亡
run 方法执行完之后
线程5个状态之间是如何转换? 用Runnable实现多线程?   实现 Runnable 接口
  重写 run 方法
  创建 Runnable 子类对象
  创建 Thread 对象， 并且把 Runnable 子类对象作为参数传递
  start 方法
  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  public class RunnableDemo { public static void main(String[] args) { MyRunnable myRunnable = new MyRunnable(); Thread thread = new Thread(myRunnable); thread."/>
<meta name="application-name" content="xiaonan&#39;s Blog">
<meta name="apple-mobile-web-app-title" content="xiaonan&#39;s Blog"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://fengqigang.cn/posts/day20/" /><link rel="prev" href="http://fengqigang.cn/posts/day19/" /><link rel="next" href="http://fengqigang.cn/posts/day21/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Day20",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/fengqigang.cn\/posts\/day20\/"
        },"genre": "posts","keywords": "java","wordcount":  193 ,
        "url": "http:\/\/fengqigang.cn\/posts\/day20\/","datePublished": "2021-04-21T17:00:51+08:00","dateModified": "2021-04-21T00:00:00+00:00","publisher": {
            "@type": "Organization",
            "name": "xiaonan"},"author": {
                "@type": "Person",
                "name": "xiaonan"
            },"description": ""
    }
    </script></head>
    <body header-desktop="auto" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="xiaonan&#39;s Blog">xiaonan&#39;s Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> categories </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="xiaonan&#39;s Blog">xiaonan&#39;s Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">categories</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Day20</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="fengqigang.cn" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>xiaonan</a></span>&nbsp;<span class="post-category">included in <a href="/categories/%E7%8E%8B%E9%81%93/"><i class="far fa-folder fa-fw"></i>王道</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2021-04-21">2021-04-21</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;193 words&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;One minute&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#线程有哪5种状态">线程有哪5种状态?</a></li>
        <li><a href="#线程5个状态之间是如何转换">线程5个状态之间是如何转换?</a></li>
        <li><a href="#用runnable实现多线程">用Runnable实现多线程?</a></li>
        <li><a href="#为什么-runnable-接口子类的-run-方法代码-会执行在子线程当中">为什么 Runnable 接口子类的 run() 方法代码， 会执行在子线程当中？</a></li>
        <li><a href="#runnable-对象代表线程吗">Runnable 对象代表线程吗?</a></li>
        <li><a href="#继承-thread-与-实现-runnable-两种方式的比较">继承 Thread 与 实现 Runnable 两种方式的比较?</a></li>
        <li><a href="#什么时候会产生数据安全问题">什么时候会产生数据安全问题?</a></li>
        <li><a href="#什么是原子操作">什么是原子操作?</a></li>
        <li><a href="#如何解决数据安全问题">如何解决数据安全问题?</a></li>
        <li><a href="#什么是-synchronized-同步">什么是 <strong>synchronized</strong> 同步?</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h3 id="线程有哪5种状态">线程有哪5种状态?</h3>
<p><strong>新建</strong>:</p>
<p>刚创建的线程，没有执行 start() 方法， 没有资格去挣抢CPU资源</p>
<p><strong>就绪</strong></p>
<p>刚执行了 <strong>start</strong> 方法， 但是还没有获得CPU的执行权</p>
<p><strong>执行</strong></p>
<p>抢到了 CPU的执行权</p>
<p><strong>阻塞</strong></p>
<p>没有 CPU 的执行权，还缺少必要的条件（sleep 结束）</p>
<p><strong>死亡</strong></p>
<p>run 方法执行完之后</p>
<h3 id="线程5个状态之间是如何转换">线程5个状态之间是如何转换?</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.fengqigang.cn//img/20210421095335.png"
        data-srcset="https://img.fengqigang.cn//img/20210421095335.png, https://img.fengqigang.cn//img/20210421095335.png 1.5x, https://img.fengqigang.cn//img/20210421095335.png 2x"
        data-sizes="auto"
        alt="https://img.fengqigang.cn//img/20210421095335.png"
        title="https://img.fengqigang.cn//img/20210421095335.png" /></p>
<h3 id="用runnable实现多线程">用Runnable实现多线程?</h3>
<ol>
<li>
<p>实现 Runnable 接口</p>
</li>
<li>
<p>重写 run 方法</p>
</li>
<li>
<p>创建 Runnable 子类对象</p>
</li>
<li>
<p>创建 Thread 对象， 并且把 Runnable 子类对象作为参数传递</p>
</li>
<li>
<p>start 方法</p>
</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">RunnableDemo</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">MyRunnable</span> <span class="n">myRunnable</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyRunnable</span><span class="o">();</span>
        <span class="n">Thread</span> <span class="n">thread</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="n">myRunnable</span><span class="o">);</span>

        <span class="n">thread</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">()</span> <span class="o">+</span> <span class="s">&#34;--------&#34;</span> <span class="o">+</span> <span class="n">i</span><span class="o">);</span>
        <span class="o">}</span>

    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">MyRunnable</span> <span class="kd">implements</span> <span class="n">Runnable</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">()</span> <span class="o">+</span> <span class="s">&#34;-------&#34;</span> <span class="o">+</span> <span class="n">i</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="为什么-runnable-接口子类的-run-方法代码-会执行在子线程当中">为什么 Runnable 接口子类的 run() 方法代码， 会执行在子线程当中？</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.fengqigang.cn//img/20210421101452.png"
        data-srcset="https://img.fengqigang.cn//img/20210421101452.png, https://img.fengqigang.cn//img/20210421101452.png 1.5x, https://img.fengqigang.cn//img/20210421101452.png 2x"
        data-sizes="auto"
        alt="https://img.fengqigang.cn//img/20210421101452.png"
        title="https://img.fengqigang.cn//img/20210421101452.png" /></p>
<h3 id="runnable-对象代表线程吗">Runnable 对象代表线程吗?</h3>
<p>不代表， thread 才代表</p>
<p>Runnable 子类对象， 并不代表线程，它只代表，要在线程中执行的任务</p>
<p>线程就是一条执行路径，至于在线程这条执行路径上，究竟执行的是什么样的具体代码，与线程没有关系的</p>
<h3 id="继承-thread-与-实现-runnable-两种方式的比较">继承 Thread 与 实现 Runnable 两种方式的比较?</h3>
<p><strong>Thread</strong></p>
<p>Runnable 实现步骤少</p>
<p>实现方式，存在单重继承的局限性</p>
<p><strong>Runnable</strong></p>
<p>将线程与任务解藕</p>
<p>便于多线程数据的共享</p>
<h3 id="什么时候会产生数据安全问题">什么时候会产生数据安全问题?</h3>
<p>多线程运行环境</p>
<p>多线程访问共享数据</p>
<p>存在一个非原子操作</p>
<p><strong>有重复的票</strong>
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.fengqigang.cn//img/20210421112502.png"
        data-srcset="https://img.fengqigang.cn//img/20210421112502.png, https://img.fengqigang.cn//img/20210421112502.png 1.5x, https://img.fengqigang.cn//img/20210421112502.png 2x"
        data-sizes="auto"
        alt="https://img.fengqigang.cn//img/20210421112502.png"
        title="https://img.fengqigang.cn//img/20210421112502.png" /></p>
<p><strong>有不存在的票</strong>
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.fengqigang.cn//img/20210421113130.png"
        data-srcset="https://img.fengqigang.cn//img/20210421113130.png, https://img.fengqigang.cn//img/20210421113130.png 1.5x, https://img.fengqigang.cn//img/20210421113130.png 2x"
        data-sizes="auto"
        alt="https://img.fengqigang.cn//img/20210421113130.png"
        title="https://img.fengqigang.cn//img/20210421113130.png" /></p>
<h3 id="什么是原子操作">什么是原子操作?</h3>
<p>一个操作要么一次执行完，一次都不执行</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.fengqigang.cn//img/20210421112013.png"
        data-srcset="https://img.fengqigang.cn//img/20210421112013.png, https://img.fengqigang.cn//img/20210421112013.png 1.5x, https://img.fengqigang.cn//img/20210421112013.png 2x"
        data-sizes="auto"
        alt="https://img.fengqigang.cn//img/20210421112013.png"
        title="https://img.fengqigang.cn//img/20210421112013.png" /></p>
<p><strong>tickets</strong></p>
<p>不是原子操作</p>
<h3 id="如何解决数据安全问题">如何解决数据安全问题?</h3>
<p>逻辑上， 解决把 <strong>一组操作变成原子的操作</strong> 的这件事情</p>
<p><strong>思路1:</strong></p>
<p>只在一个线程上，对共享变量的一组操作的执行过程，能够阻止线程切换</p>
<p><strong>无法实现</strong></p>
<p>java 是采取抢占式线程调度，代码层面(线程中执行的代码), 无法控制线程调度</p>
<p><strong>思路2:</strong></p>
<p>把共享变量，加一把锁，利用锁来实现原子的操作，使用锁，可以给共享加锁，从面保证:</p>
<p>a. 只有加锁的线程，能够访问到共享变量</p>
<p>b. 在加锁线程中，没有完成对共享变量的一组操作之前，不会释放锁</p>
<p>c. 只要不释放锁，其他线程，即使被调度执行，也无法访问共享变量</p>
<h3 id="什么是-synchronized-同步">什么是 <strong>synchronized</strong> 同步?</h3>
<ol>
<li>
<p>同步的代码块中的锁对象可以是任意的 java 对象</p>
</li>
<li>
<p>一定要保证是同一个对象</p>
</li>
</ol>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img.fengqigang.cn//img/20210421115103.png"
        data-srcset="https://img.fengqigang.cn//img/20210421115103.png, https://img.fengqigang.cn//img/20210421115103.png 1.5x, https://img.fengqigang.cn//img/20210421115103.png 2x"
        data-sizes="auto"
        alt="https://img.fengqigang.cn//img/20210421115103.png"
        title="https://img.fengqigang.cn//img/20210421115103.png" /></p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2021-04-21</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/java/">java</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/day19/" class="prev" rel="prev" title="Day19"><i class="fas fa-angle-left fa-fw"></i>Day19</a>
            <a href="/posts/day21/" class="next" rel="next" title="Day21">Day21<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.82.1">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2019 - 2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="fengqigang.cn" target="_blank">xiaonan</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/katex/katex.min.css"><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/auto-render.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
